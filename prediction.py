# -*- coding: utf-8 -*-
"""prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DETri_J7VjFYKCj6LQ0MqL05syD0nPwx
"""

import pickle
import pandas as pd
import numpy as np
import warnings

# 1. Load Model
def load_model(model_path):
    with open(model_path, 'rb') as file:
        model = pickle.load(file)
    return model

# 2. Fungsi Prediksi
def predict(input_data, model):
    """Input: DataFrame atau dictionary, Output: Prediksi kelas dan probabilitas."""
    # Konversi input ke DataFrame jika berupa dictionary
    if isinstance(input_data, dict):
        input_df = pd.DataFrame([input_data])
    else:
        input_df = input_data

    # Prediksi
    prediction = model.predict(input_df)
    prediction_proba = model.predict_proba(input_df)

    return {
        "class": prediction[0],
        "probabilities": {
            "class_0": float(prediction_proba[0][0]),
            "class_1": float(prediction_proba[0][1])
        }
    }


if __name__ == "__main__":
    # Load model
    model = load_model('best_model.pkl')

new_data = {
    'EmployeeId': 1,
    'Age': 35,
    'DailyRate': 800,
    'DistanceFromHome': 50,
    'HourlyRate': 50,
    'MonthlyIncome': 5000,
    'MonthlyRate': 20000,
    'TotalWorkingYears': 8,
    'YearsAtCompany': 5,
    'OverTime_Yes': 1
}

result = predict(new_data, model)
print("Hasil Prediksi:", result)

